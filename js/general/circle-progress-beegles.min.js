!function(t){if("function"==typeof define&&define.amd)define(["jquery"],t);else if("object"==typeof module&&module.exports){var i=require("jquery");t(i),module.exports=i}else t(jQuery)}(function(g){function n(t){this.init(t)}n.prototype={value:0,size:100,startAngle:-Math.PI,thickness:"auto",fill:{gradient:["#3aeabb","#fdd250"]},emptyFill:"rgba(0, 0, 0, .1)",animation:{duration:1200,easing:"circleProgressEasing"},animationStartValue:0,reverse:!1,lineCap:"butt",insertMode:"prepend",constructor:n,el:null,canvas:null,ctx:null,radius:0,arcFill:null,lastFrameValue:0,init:function(t){g.extend(this,t),this.radius=this.size/2,this.initWidget(),this.initFill(),this.draw(),this.el.trigger("circle-inited")},initWidget:function(){this.canvas||(this.canvas=g("<canvas>")["prepend"==this.insertMode?"prependTo":"appendTo"](this.el)[0]);var t=this.canvas;if(t.width=this.size,t.height=this.size,this.ctx=t.getContext("2d"),1<window.devicePixelRatio){var i=window.devicePixelRatio;t.style.width=t.style.height=this.size+"px",t.width=t.height=this.size*i,this.ctx.scale(i,i)}},initFill:function(){var i,e=this,t=this.fill,a=this.ctx,s=this.size;if(!t)throw Error("The fill is not specified!");if("string"==typeof t&&(t={color:t}),t.color&&(this.arcFill=t.color),t.gradient){var r=t.gradient;if(1==r.length)this.arcFill=r[0];else if(1<r.length){for(var n=t.gradientAngle||0,h=t.gradientDirection||[s/2*(1-Math.cos(n)),s/2*(1+Math.sin(n)),s/2*(1+Math.cos(n)),s/2*(1-Math.sin(n))],l=a.createLinearGradient.apply(a,h),o=0;o<r.length;o++){var c=r[o],d=o/(r.length-1);g.isArray(c)&&(d=c[1],c=c[0]),l.addColorStop(d,c)}this.arcFill=l}}t.image&&(t.image instanceof Image?i=t.image:(i=new Image).src=t.image,i.complete?u():i.onload=u);function u(){var t=g("<canvas>")[0];t.width=e.size,t.height=e.size,t.getContext("2d").drawImage(i,0,0,s,s),e.arcFill=e.ctx.createPattern(t,"no-repeat"),e.drawFrame(e.lastFrameValue)}},draw:function(){this.animation?this.drawAnimated(this.value):this.drawFrame(this.value)},drawFrame:function(t){this.lastFrameValue=t,this.ctx.clearRect(0,0,this.size,this.size),this.drawEmptyArc(t),this.drawArc(t)},drawArc:function(t){if(0!==t){var i=this.ctx,e=this.radius,a=this.getThickness(),s=this.startAngle;i.save(),i.beginPath(),this.reverse?i.arc(e,e,e-a/2,s-2*Math.PI*t,s):i.arc(e,e,e-a/2,s,s+2*Math.PI*t),i.lineWidth=a,i.lineCap=this.lineCap,i.strokeStyle=this.arcFill,i.stroke(),i.restore()}},drawEmptyArc:function(t){var i=this.ctx,e=this.radius,a=this.getThickness(),s=this.startAngle;t<1&&(i.save(),i.beginPath(),t<=0?i.arc(e,e,e-a/2,0,2*Math.PI):this.reverse?i.arc(e,e,e-a/2,s,s-2*Math.PI*t):i.arc(e,e,e-a/2,s+2*Math.PI*t,s),i.lineWidth=a,i.strokeStyle=this.emptyFill,i.stroke(),i.restore())},drawAnimated:function(e){var a=this,s=this.el,t=g(this.canvas);t.stop(!0,!1),s.trigger("circle-animation-start"),t.css({animationProgress:0}).animate({animationProgress:1},g.extend({},this.animation,{step:function(t){var i=a.animationStartValue*(1-t)+e*t;a.drawFrame(i),s.trigger("circle-animation-progress",[t,i])}})).promise().always(function(){s.trigger("circle-animation-end")})},getThickness:function(){return g.isNumeric(this.thickness)?this.thickness:this.size/14},getValue:function(){return this.value},setValue:function(t){this.animation&&(this.animationStartValue=this.lastFrameValue),this.value=t,this.draw()}},g.circleProgress={defaults:n.prototype},g.easing.circleProgressEasing=function(t){return t<.5?.5*(t*=2)*t*t:1-.5*(t=2-2*t)*t*t},g.fn.circleProgress=function(s,t){var r="circle-progress",i=this.data(r);if("widget"==s){if(!i)throw Error('Calling "widget" method on not initialized instance is forbidden');return i.canvas}if("value"!=s)return this.each(function(){var t=g(this),i=t.data(r),e=g.isPlainObject(s)?s:{};if(i)i.init(e);else{var a=g.extend({},t.data());"string"==typeof a.fill&&(a.fill=JSON.parse(a.fill)),"string"==typeof a.animation&&(a.animation=JSON.parse(a.animation)),(e=g.extend(a,e)).el=t,i=new n(e),t.data(r,i)}});if(!i)throw Error('Calling "value" method on not initialized instance is forbidden');if(void 0===t)return i.getValue();var e=t;return this.each(function(){g(this).data(r).setValue(e)})}}),$(function(){$.circleProgress.defaults.arcCoef=.5,$.circleProgress.defaults.startAngle=.5*Math.PI,$.circleProgress.defaults.drawArc=function(t){var i=this.ctx,e=this.radius,a=this.getThickness(),s=this.arcCoef,r=this.startAngle+(1-s)*Math.PI;t=Math.max(0,Math.min(1,t)),i.save(),i.beginPath(),this.reverse?i.arc(e,e,e-a/2,r+2*s*Math.PI,r+2*s*(1-t)*Math.PI,r):i.arc(e,e,e-a/2,r,r+2*s*Math.PI*t),i.lineWidth=a,i.lineCap=this.lineCap,i.strokeStyle=this.arcFill,i.stroke(),i.restore()},$.circleProgress.defaults.drawEmptyArc=function(t){var i=this.ctx,e=this.radius,a=this.getThickness(),s=this.arcCoef,r=this.startAngle+(1-s)*Math.PI;(t=Math.max(0,Math.min(1,t)))<1&&(i.save(),i.beginPath(),t<=0?i.arc(e,e,e-a/2,r,r+2*s*Math.PI):this.reverse?i.arc(e,e,e-a/2,r,r+2*s*(1-t)*Math.PI):i.arc(e,e,e-a/2,r+2*s*Math.PI*t,r+2*s*Math.PI),i.lineWidth=a,i.strokeStyle=this.emptyFill,i.stroke(),i.restore())}});